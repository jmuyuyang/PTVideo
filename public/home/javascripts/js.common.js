
String.prototype.replaceAll=function($1,$2){return this.replace(new RegExp($1,"gm"),$2);}
var commonClient=new Object();commonClient.Tool=function(){};commonClient.Tool.prototype={AjaxDomain:function(){return"http://h5.qidian.com";},GetPops:function(){var frameContent=arguments[0]||"";var title=arguments[1]||"";var width=arguments[2]||"";var height=arguments[3]||"";return'<div class="popup pop-s" style="width:450px;">'+'<div style="background:none repeat scroll 0 0 white;height:100%" >'+'<div class="topbar"><a href="javascript:void(0);" onclick="jQuery.closeAllDialog();" class="close">关闭</a><strong>'+title+'</strong></div>'+'<div class="lp-warp" style="width:'+width+';height:'+height+'">'+
frameContent+'</div>'+'</div></div>';},HtmlParse:function(){var html=arguments[0]||'';var obj=arguments[1]||{};var left="{";var right="}";if(typeof obj!='object')return'';return html.replace(new RegExp(left+"([^\\{\\}]*?)"+right,'igm'),function($,$1){return obj[$1]?obj[$1]:$});},GetReadBook:function(){var BookId=arguments[0];var LastUpdateChapterID=arguments[1];var isVip=arguments[2];if(isVip==1){if(!common.checkLoginByCookie()){common.ShowLogin();}else{window.location.href='/bookreader.html?bookId='+BookId+'&chapterId='+LastUpdateChapterID+'';}}else{window.location.href='/bookreader.html?bookId='+BookId+'&chapterId='+LastUpdateChapterID+'';}},logout:function(){var domain="qidian.com";if(location.hostname.indexOf("qdmm.com")>=0){domain="qdmm.com";}
else if(location.hostname.indexOf("qdwenxue.com")>=0){domain="qdwenxue.com";}
document.cookie="CAS_DEFAULTUSERKEY=; path=/"+";domain="+domain;common.SsoLogin("http://s.if.qidian.com/","user=0&otype=-1","location.href = 'https://cas.sdo.com/cas/logout?url="+encodeURIComponent(location.href)+"';");},SsoLogin:function(url,args,callBack){if(window.opera){var iframe=document.createElement("iframe");iframe.src=url+"sso.aspx?"+args+"&"+Math.random();iframe.style.display="none";document.body.appendChild(iframe);iframe.onload=function(){eval(callBack);this.parentNode.removeChild(this);}}
else{var head=document.getElementsByTagName("head")[0];var element=document.createElement("script");element.src=url+"sso.aspx?"+args+"&"+Math.random();element.type="text/javascript";element.id='sso';head.appendChild(element);if(callBack!=undefined){if(document.all){element.onreadystatechange=function(){if(element.readyState=="loaded"||element.readyState=="complete"){eval(callBack);return;}}}
else{element.onload=function(){eval(callBack);}}}}},ShowLogin:function(){var _oa_domain="avd.qidian.com";document.cookie='loginType=; path=/;domain='+document.domain;var _frame=document.getElementById('SdoOALoginIframeBar');var _local=location.href;var _style=_local+"/css/bookstore.css";var _returnUrl='http://'+_oa_domain+'/OALoginJump.aspx?returnURL='+encodeURIComponent(_local);var warntext="两周内会为您自动登录起点，为保障您的账号安全，请不要在网吧等公共计算机上使用此设置";var _regtitle="注册";var oapa='target=top';oapa+='&style=2';var frameSrc='http://login.sdo.com/sdo/Login/LoginFrameFC.php?reg_param=from%3D10&appId=10&areaId=1&'+oapa+'&returnURL='+encodeURIComponent(_returnUrl);var content='<iframe id="iframeLogin" height="250px" frameborder="0" width="400px" allowtransparency="true" name="iframeLogin" scrolling="No" src="'+frameSrc+'"></iframe>';var dia=new(jQuery.dialog)({htmlOrUrl:common.GetPops(content,"起点读书欢迎您","400px","250px;"),hasButton:false,hasFrame:false,contentWidth:'430px'});dia.open();$('.popframe .frame').removeClass("opacity");$('.popframe .frame').removeClass("opacity");$('.alert_box.popFrame tbody tr:eq(0)').empty();$('.alert_box.popFrame tbody tr:eq(2)').empty();},ConvertToImage:function(){var imageExist=arguments[0]||0;var bookId=arguments[1]||1;if(imageExist==0)
return"http://vod2.xmeye.com:8080/ptvideo/images/1330065165_pic_th.jpg";else
return"http://vod2.xmeye.com:8080/ptvideo/images/"+moviesId+".jpg";},Hashtable:function(){this._hash=new Object();this.add=function(key,value){if(typeof(key)!="undefined"){if(this.contains(key)==false){this._hash[key]=typeof(value)=="undefined"?null:value;return true;}else{return false;}}else{return false;}}
this.remove=function(key){delete this._hash[key];}
this.count=function(){var i=0;for(var k in this._hash){i++;}return i;}
this.items=function(key){return this._hash[key];}
this.contains=function(key){return typeof(this._hash[key])!="undefined";}
this.clear=function(){for(var k in this._hash){delete this._hash[k];}}
this.keys=function(){var key=new Array();for(var k in this._hash){key.push(k);}return key;}},JsonDateConvert:function(){var date=arguments[0];var re=/-?\d+/;var m=re.exec(date);var d=new Date(parseInt(m[0]));return d;},ParseJsonDate:function(){var jsonDate=arguments[0];var date=new Date(parseInt(jsonDate.substr(6)));return date.getFullYear()+"-"+(date.getMonth()+1)+"-"+date.getDate()+" "+date.getHours()+":"+(date.getMinutes()<10?("0"+date.getMinutes()):date.getMinutes())+":"+(date.getSeconds()<10?("0"+date.getSeconds()):date.getSeconds());},GetCurrDate:function(){var now=new Date();var year=now.getFullYear();var month=now.getMonth()+1;var day=now.getDate();var hh=now.getHours();var mm=now.getMinutes();var clock=year+"-";if(month<10)
clock+="0";clock+=month+"-";if(day<10)
clock+="0";clock+=day+" ";if(hh<10)
clock+="0";clock+=hh+":";if(mm<10)clock+='0';clock+=mm;return(clock);},Request:function(){var paras=arguments[0];var url=location.href;var paraString=url.substring(url.indexOf("?")+1,url.length).split("&");var paraObj={}
for(i=0;j=paraString[i];i++){paraObj[j.substring(0,j.indexOf("=")).toLowerCase()]=j.substring(j.indexOf("=")+1,j.length);}
var returnValue=paraObj[paras.toLowerCase()];if(typeof(returnValue)=="undefined"){return"";}else{return returnValue;}},checkLoginByCookie:function(){var cookieId="AUTHTEST";if(window.location.href.toLowerCase().indexOf("qidian.com")>-1){cookieId="cmfuToken";}
if(window.location.href.toLowerCase().indexOf("qidianmm.com")>-1){cookieId="cmfuToken";}
if(window.location.href.toLowerCase().indexOf("qdmm.com")>-1){cookieId="cmfuToken";}
if(window.location.href.toLowerCase().indexOf("qdwenxue.com")>-1){cookieId="cmfuToken";}
if((common.GetCookie(cookieId)!=null&&common.GetCookie(cookieId).length>0)){return true;}
return false;},SetCookie:function(name,value)
{var expdate=new Date();var argv=arguments;var argc=arguments.length;var expires=(argc>2)?argv[2]:null;var path=(argc>3)?argv[3]:null;var domain=(argc>4)?argv[4]:null;var secure=(argc>5)?argv[5]:false;if(expires!=null)expdate.setTime(expdate.getTime()+(expires*1000));document.cookie=name+"="+escape(value)+((expires==null)?"":("; expires="+expdate.toGMTString()))
+((path==null)?"":("; path="+path))+((domain==null)?"":("; domain="+domain))
+((secure==true)?"; secure":"");},DelCookie:function(name)
{var exp=new Date();exp.setTime(exp.getTime()-1);var cval=GetCookie(name);document.cookie=name+"="+cval+"; expires="+exp.toGMTString();},GetCookie:function(cookieName){var cookieString=document.cookie;var start=cookieString.indexOf(cookieName+'=');if(start==-1)return null;start+=cookieName.length+1;var end=cookieString.indexOf(';',start);if(end==-1)return unescape(cookieString.substring(start));return unescape(cookieString.substring(start,end));},IsSupportScreen:function(){var isSupport=true;var defaultWidth=1024,width=screen.width;if(screen.width<=screen.height){width=screen.height;}
if(width<defaultWidth){isSupport=false;}
return isSupport;},IsSupport:function(){var isSupport=true;if(navigator.userAgent.toLowerCase().indexOf("opera")>-1&&(navigator.userAgent.toLowerCase().indexOf("ipad")>-1||navigator.userAgent.toLowerCase().indexOf("android")>-1)){isSupport=false;}
if(!+[1,]){isSupport=false;}
return isSupport;},IsPad:function(){return typeof(window.ontouchstart)!='undefined';}};var scrollLoad=(function(options){var defaults=(arguments.length==0)?{src:'xSrc',time:300,time:300,loadCount:2,firstLoadCount:6}:{src:options.src||'xSrc',time:options.time||300,loadCount:options.loadCount||2,firstLoadCount:options.firstLoadCount||6};var camelize=function(s){return s.replace(/-(\w)/g,function(strMatch,p1){return p1.toUpperCase();});};this.getStyle=function(element,property){if(arguments.length!=2)return false;var value=element.style[camelize(property)];if(!value){if(document.defaultView&&document.defaultView.getComputedStyle){var css=document.defaultView.getComputedStyle(element,null);value=css?css.getPropertyValue(property):null;}else if(element.currentStyle){value=element.currentStyle[camelize(property)];}}
return value=='auto'?'':value;};var _init=function(){var defaultCount=defaults.loadCount;if(arguments!=null&&arguments.length==1){defaultCount=defaults.firstLoadCount;}
var offsetPage=window.pageYOffset?window.pageYOffset:window.document.documentElement.scrollTop,offsetWindow=offsetPage+Number(window.innerHeight?window.innerHeight:document.documentElement.clientHeight),docImg=document.images,_len=docImg.length;if(!_len)return false;var count=0;for(var i=0;i<_len;i++){var attrSrc=docImg[i].getAttribute(defaults.src),o=docImg[i],tag=o.nodeName.toLowerCase();if(o){postPage=o.getBoundingClientRect().top+window.document.documentElement.scrollTop+window.document.body.scrollTop;if(attrSrc&&attrSrc!=null&&attrSrc.length>0){var theImage=new Image();theImage.src=attrSrc;postWindow=postPage+Number(theImage.height);if((postPage>offsetPage&&postPage<offsetWindow)||(postWindow>offsetPage&&postWindow<offsetWindow)){if(tag==="img"&&attrSrc!==null){if(o.src!=attrSrc){o.setAttribute("src",attrSrc);count++;if(count>=defaultCount){break;}}}
o=null;}}}};window.onscroll=function(){setTimeout(function(){_init();},defaults.time);}};return _init(defaults.firstLoadCount);});var common=new commonClient.Tool();$(document).ready(function(){if(!common.IsSupport()||!common.IsSupportScreen()){if(!common.IsSupportScreen()&&location.href.toString().indexOf("tips")<0){location.href="/tips.html";}
else{var html='<div class="popup-tip"><div class="pp-title">友情提示</div><div class="pp-content">';html+='<div style="padding: 0 0 10px; text-align: center;"><img src="images/pop-logo.gif" alt="" /></div>';html+='<p>本网站采用html5技术构建，由于您的浏览器对html5兼容性问题，暂不支持您的浏览器访问本站，推荐您使用Chrome、Firefox、Safari、OPERA、IE9或者平板设备打开本站。</p>';html+='<p align="center" style="font-size: 18px; position: relative;">现在也可以直接访问起点主站 <a href="http://www.qidian.com" style="color: red">www.qidian.com</a></p>';html+='<p align="center" style="font-size: 24px;">谢谢您的光临！</p></div>';html+='<dl class="download-browser"><dt>下载·HTML5浏览器</dt><dd><ul>';html+='<li><a href="http://www.google.cn/chrome" class="gc" target="_blank">google chrome</a></li>';html+='<li><a href="http://www.firefox.com.cn/download/" class="mf" target="_blank">firefox</a></li>';html+='<li><a href="http://www.opera.com/browser/" class="op" target="_blank">opera</a></li>';html+='<li><a href="http://www.apple.com.cn/safari/download/" class="as" target="_blank">safari</a></li>';html+='<li><a href="http://info.msn.com.cn/ie9/" class="mi" target="_blank">ie9</a></li>';html+='</ul></dd></dl></div><div class="popup-tip-bg"></div>';new(jQuery.dialog)({htmlOrUrl:html,hasButton:false,hasFrame:false}).open();$(".alert_box_bg").css("background-color","gray").css("opacity","1");$(".alert_box_container table tr").eq(0).hide();$(".alert_box_container table tr").eq(2).hide();}}});